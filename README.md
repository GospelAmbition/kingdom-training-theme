# Kingdom.Training WordPress Theme

A modern headless WordPress theme with a React frontend built with Vite, TypeScript, and Tailwind CSS. Designed for Media to Disciple Making Movements (M2DMM) training, featuring multilingual support via Polylang.

## Table of Contents

- [Overview](#overview)
- [Features](#features)
- [Project Structure](#project-structure)
- [Prerequisites](#prerequisites)
- [Installation](#installation)
- [WordPress Setup](#wordpress-setup)
- [Frontend Development](#frontend-development)
- [Multilingual Support](#multilingual-support)
- [API Endpoints](#api-endpoints)
- [Deployment](#deployment)
- [Development Guidelines](#development-guidelines)
- [Troubleshooting](#troubleshooting)
- [License](#license)

## Overview

This theme transforms WordPress into a headless CMS, serving content via the REST API to a modern React frontend. The frontend is built with Vite and TypeScript, providing a fast, type-safe development experience. The theme is specifically designed for Kingdom.Training, which focuses on training disciple makers to use media strategically for Disciple Making Movements.

### Architecture

- **Backend**: WordPress (headless CMS)
- **Frontend**: React 18 + TypeScript + Vite
- **Styling**: Tailwind CSS
- **Routing**: React Router (client-side)
- **Multilingual**: Polylang integration
- **Build Tool**: Vite with automatic code splitting

## Features

### Core Features

- âš¡ **Fast Development** - Vite-powered build system with hot module replacement
- ðŸŽ¨ **Modern UI** - Responsive design with Tailwind CSS
- ðŸŒ **Multilingual** - Full Polylang integration with language switching
- ðŸ“± **Mobile-First** - Responsive design optimized for all devices
- ðŸ” **Authentication** - WordPress user authentication integration
- ðŸ” **SEO Optimized** - Meta tags, structured data, and semantic HTML
- â™¿ **Accessible** - ARIA labels and keyboard navigation support

### Content Types

- **Strategy Courses** - Comprehensive M2DMM training courses with step-by-step progression
- **Articles** - Practical guidance, best practices, and insights
- **Tools** - Essential resources and tools for M2DMM practitioners

### Technical Features

- TypeScript for type safety
- React Router for client-side routing
- REST API integration with custom endpoints
- Custom post types with REST API support
- Featured image handling
- Author information display
- Progress tracking for course completion
- Search functionality
- Newsletter integration

## Project Structure

```
kingdom-training-theme/
â”œâ”€â”€ style.css              # Theme information and WordPress header
â”œâ”€â”€ functions.php          # WordPress functionality & REST API customization
â”œâ”€â”€ index.php             # Fallback template (WordPress requirement)
â”œâ”€â”€ header.php            # HTML head with meta tags
â”œâ”€â”€ footer.php            # HTML footer
â”œâ”€â”€ dist/                 # Built frontend files (generated by build:theme)
â”‚   â”œâ”€â”€ index.html        # Main HTML file
â”‚   â”œâ”€â”€ assets/           # Compiled JS and CSS
â”‚   â””â”€â”€ [static assets]   # Images and other static files
â”œâ”€â”€ frontend/             # React/Vite application source
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/        # React Router pages
â”‚   â”‚   â”‚   â”œâ”€â”€ HomePage.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ArticlesPage.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ArticleDetailPage.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ StrategyCoursesPage.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ StrategyCourseDetailPage.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ToolsPage.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ToolDetailPage.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ AboutPage.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ LoginPage.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ NewsletterPage.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ PrivacyPage.tsx
â”‚   â”‚   â”‚   â””â”€â”€ NotFoundPage.tsx
â”‚   â”‚   â”œâ”€â”€ components/   # React components
â”‚   â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Footer.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ LanguageSelector.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ SearchModal.tsx
â”‚   â”‚   â”‚   â””â”€â”€ [other components]
â”‚   â”‚   â”œâ”€â”€ hooks/        # Custom React hooks
â”‚   â”‚   â”‚   â””â”€â”€ useTranslation.ts
â”‚   â”‚   â”œâ”€â”€ lib/          # Utilities and API functions
â”‚   â”‚   â”‚   â”œâ”€â”€ wordpress.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ translations.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ utils.ts
â”‚   â”‚   â”‚   â””â”€â”€ auth.ts
â”‚   â”‚   â”œâ”€â”€ styles/       # Global styles
â”‚   â”‚   â”‚   â””â”€â”€ globals.css
â”‚   â”‚   â”œâ”€â”€ App.tsx       # Main app component with routing
â”‚   â”‚   â””â”€â”€ main.tsx      # Application entry point
â”‚   â”œâ”€â”€ public/           # Static assets
â”‚   â”œâ”€â”€ scripts/         # Build scripts
â”‚   â”‚   â”œâ”€â”€ copy-to-theme.js
â”‚   â”‚   â””â”€â”€ watch-and-copy.js
â”‚   â”œâ”€â”€ package.json      # Node dependencies
â”‚   â”œâ”€â”€ vite.config.ts    # Vite configuration
â”‚   â”œâ”€â”€ tailwind.config.js
â”‚   â””â”€â”€ tsconfig.json
â”œâ”€â”€ cli/                  # CLI utilities and documentation
â””â”€â”€ README.md            # This file
```

## Prerequisites

### Required

- **WordPress** 5.8+ (with REST API enabled)
- **PHP** 7.4+
- **Node.js** 18+ and npm
- **Polylang** plugin (for multilingual support)

### Recommended WordPress Plugins

- **Polylang** - Multilingual support
- **Advanced Custom Fields (ACF)** - Custom field management (optional)
- **Yoast SEO** or similar - SEO optimization (optional)

## Installation

### 1. WordPress Theme Installation

1. Clone or download this repository
2. Upload the entire `kingdom-training-theme` directory to your WordPress installation:
   ```
   /wp-content/themes/kingdom-training-theme/
   ```
3. Activate the theme in WordPress Admin â†’ Appearance â†’ Themes

### 2. Frontend Dependencies

```bash
cd frontend
npm install
```

### 3. Build Frontend

```bash
npm run build:theme
```

This will:
- Build the React application
- Copy all files to the theme's `dist/` directory
- Make the frontend available through WordPress

## WordPress Setup

### Permalinks Configuration

1. Go to **Settings â†’ Permalinks**
2. Select **"Post name"** permalink structure
3. Click **Save Changes**

This is required for proper routing and REST API functionality.

### Menu Setup

1. Go to **Appearance â†’ Menus**
2. Create a new menu named "Primary"
3. Add links to:
   - Strategy Courses
   - Articles
   - Tools
   - About
4. Assign the menu to the "Primary" location

### Custom Post Types

The theme automatically registers three custom post types:

| Post Type | REST API Endpoint | Description |
|-----------|------------------|-------------|
| `strategy_course` | `/wp-json/wp/v2/strategy-courses` | Training courses with step progression |
| `article` | `/wp-json/wp/v2/articles` | Blog-style articles |
| `tool` | `/wp-json/wp/v2/tools` | Tools and resources |

All custom post types support:
- Title, content, excerpt
- Featured images
- Custom fields (via ACF or meta)
- Categories and tags
- REST API access
- Polylang language assignment

## Frontend Development

### Development Workflow

#### Option 1: Watch Mode (Recommended)

For continuous development with automatic rebuilding:

```bash
cd frontend
npm run watch
```

This will:
- Watch for file changes
- Automatically rebuild on save
- Copy files to the theme's `dist/` directory
- Your WordPress site will serve the updated files immediately

#### Option 2: Standalone Dev Server

For isolated frontend development:

```bash
cd frontend
npm run dev
```

Visit `http://localhost:3000` to see the frontend.

**Note**: This requires setting `VITE_WORDPRESS_API_URL` in a `.env` file for API calls to work.

### Available Scripts

| Command | Description |
|---------|-------------|
| `npm run dev` | Start Vite dev server (standalone) |
| `npm run build` | Build for production |
| `npm run build:theme` | Build and copy to theme directory |
| `npm run build:watch` | Build in watch mode |
| `npm run watch` | Watch, build, and copy automatically |
| `npm run preview` | Preview production build |
| `npm run lint` | Run ESLint |
| `npm run type-check` | TypeScript type checking |

### Environment Variables

Create a `.env` file in the `frontend/` directory for local development:

```env
VITE_WORDPRESS_API_URL=http://localhost:8888/wp-json
```

**Note**: When served from WordPress, the app automatically uses relative paths (`/wp-json`), so environment variables are only needed for standalone development.

## Multilingual Support

The theme includes full multilingual support via Polylang integration.

### Setup

1. Install and activate the **Polylang** plugin
2. Configure languages in **Languages â†’ Settings**
3. Set a default language
4. Assign language to posts, pages, and custom post types

### Features

- **Language Selector** - Dropdown component in header
- **URL-based Language Switching** - Language codes in URLs (e.g., `/en/articles`, `/es/articles`)
- **Translation System** - UI strings translated via REST API
- **Language Filtering** - Content filtered by current language
- **Default Language Handling** - Proper fallback for default language

### Language URLs

- **Default Language**: `/articles` (no prefix)
- **Other Languages**: `/es/articles`, `/fr/articles`, etc.

The language selector automatically updates URLs when switching languages.

### Translation Endpoints

- **Get Languages**: `/wp-json/gaal/v1/languages`
- **Get Translations**: `/wp-json/gaal/v1/translations?lang=en`
- **Get Default Language**: `/wp-json/gaal/v1/default-language`

## API Endpoints

### WordPress REST API

#### Custom Post Types

- `GET /wp-json/wp/v2/strategy-courses` - List strategy courses
- `GET /wp-json/wp/v2/strategy-courses/{id}` - Single strategy course
- `GET /wp-json/wp/v2/articles` - List articles
- `GET /wp-json/wp/v2/articles/{id}` - Single article
- `GET /wp-json/wp/v2/tools` - List tools
- `GET /wp-json/wp/v2/tools/{id}` - Single tool

#### Custom Endpoints

- `GET /wp-json/gaal/v1/site-info` - Site information (title, description, etc.)
- `GET /wp-json/gaal/v1/menus/{location}` - Menu data (e.g., `/gaal/v1/menus/primary`)
- `GET /wp-json/gaal/v1/languages` - Available languages (Polylang)
- `GET /wp-json/gaal/v1/default-language` - Default language code
- `GET /wp-json/gaal/v1/translations?lang={code}` - UI translations

#### Authentication Endpoints

- `POST /wp-json/gaal/v1/auth/login` - User login
- `POST /wp-json/gaal/v1/auth/logout` - User logout
- `GET /wp-json/gaal/v1/auth/me` - Get current user

### REST API Enhancements

The theme adds custom fields to REST API responses:

- `featured_image_url` - Direct URL to featured image
- `author_info` - Author name, avatar, and bio
- `language` - Language code (Polylang)
- `polylang_current_lang` - Current language information

## Deployment

### Production Build

1. **Build the frontend:**
   ```bash
   cd frontend
   npm run build:theme
   ```

2. **Upload to server:**
   - Upload the entire theme directory to `/wp-content/themes/kingdom-training-theme/`
   - Ensure the `dist/` directory is included

3. **Verify:**
   - Check that `dist/index.html` exists
   - Verify `dist/assets/` contains compiled JS and CSS
   - Test the site in a browser

### Server Requirements

- WordPress 5.8+
- PHP 7.4+
- Mod_rewrite enabled (for permalinks)
- REST API accessible

### Post-Deployment Checklist

- [ ] Permalinks configured to "Post name"
- [ ] Primary menu created and assigned
- [ ] Polylang configured (if using multilingual)
- [ ] Custom post types have content
- [ ] Featured images uploaded
- [ ] Test all routes and language switching

## Development Guidelines

### Adding Custom Fields

To expose custom fields in the REST API, edit `functions.php`:

```php
register_rest_field(
    array('strategy_course', 'article', 'tool'),
    'your_field_name',
    array(
        'get_callback' => function($object) {
            return get_post_meta($object['id'], 'your_field_name', true);
        },
        'schema' => array(
            'description' => 'Your field description',
            'type' => 'string',
        ),
    )
);
```

### Creating New Components

1. Create component file in `frontend/src/components/`
2. Use TypeScript and Tailwind CSS
3. Follow existing component patterns
4. Add translations using `useTranslation()` hook

Example:

```typescript
import { useTranslation } from '@/hooks/useTranslation';

export default function MyComponent() {
  const { t } = useTranslation();
  
  return (
    <div>
      <h1>{t('ui_my_title')}</h1>
    </div>
  );
}
```

### Adding New Pages

1. Create page component in `frontend/src/pages/`
2. Add route in `frontend/src/App.tsx`:

```typescript
<Route path="/my-page" element={<MyPage />} />
```

3. Add menu item in WordPress admin
4. Add translations for page content

### WordPress API Integration

Use utility functions in `frontend/src/lib/wordpress.ts`:

```typescript
import { getArticles, getStrategyCourses, getTools } from '@/lib/wordpress';

// Fetch articles
const articles = await getArticles({ per_page: 10 });

// Fetch strategy courses
const courses = await getStrategyCourses({ per_page: 10 });

// Fetch tools
const tools = await getTools({ per_page: 10 });
```

### Styling Guidelines

- Use Tailwind CSS utility classes
- Follow mobile-first responsive design
- Use brand colors from `tailwind.config.js`:
  - Primary: `#4169e1` (blue)
  - Secondary: `#FFD700` (gold)
  - Text: `#2F3E46` (gunmetal)
- Custom CSS classes in `frontend/src/styles/globals.css`

## Troubleshooting

### CORS Issues

If you encounter CORS errors:
1. Verify `functions.php` has CORS headers enabled
2. Check WordPress REST API is accessible: `/wp-json`
3. Ensure proper `Access-Control-Allow-Origin` headers

### API Connection Errors

1. Verify WordPress REST API is accessible: `/wp-json`
2. Check WordPress is running and accessible
3. Verify SSL certificate (if using HTTPS)
4. Check browser console for specific error messages

### Build Errors

1. Clear build cache:
   ```bash
   cd frontend
   rm -rf dist node_modules
   npm install
   npm run build:theme
   ```

2. Check Node.js version (requires 18+):
   ```bash
   node --version
   ```

3. Verify all dependencies installed:
   ```bash
   npm install
   ```

### Routing Issues

If routes don't work when served from WordPress:

1. Check `functions.php` has `kingdom_training_serve_frontend()` function
2. Verify `dist/` directory exists in theme
3. Ensure WordPress permalinks are configured
4. Check `.htaccess` file exists and is writable

### Multilingual Issues

1. Verify Polylang is installed and activated
2. Check languages are configured in Polylang settings
3. Ensure posts have language assignments
4. Check browser console for API errors
5. Verify translation endpoints are accessible

### Language Selector Not Showing

1. Check Polylang is active
2. Verify at least one language is configured
3. Check browser console for errors
4. Verify `/wp-json/gaal/v1/languages` endpoint works

## Design System

### Colors

- **Primary Blue**: `#4169e1` - Main brand color
- **Secondary Gold**: `#FFD700` - Accent color
- **Text Gray**: `#2F3E46` - Primary text color
- **Background**: White and light gray variants

### Typography

- **Font Family**: Inter (sans-serif)
- **Headings**: Bold, various sizes
- **Body**: Regular weight, readable sizes

### Components

- Responsive navigation header
- Language selector dropdown
- Content cards with hover effects
- Loading states and spinners
- Search modal
- Footer with links

## Documentation

- [Frontend README](frontend/README.md) - Detailed frontend documentation
- [CLI Documentation](cli/) - WordPress CLI utilities and guides

## Support & Resources

- **WordPress REST API**: https://developer.wordpress.org/rest-api/
- **Vite Documentation**: https://vitejs.dev/
- **React Router**: https://reactrouter.com/
- **Tailwind CSS**: https://tailwindcss.com/
- **Polylang**: https://polylang.pro/

## License

GNU General Public License v2 or later

## Mission

*"Of the sons of Issachar, men who understood the times, with knowledge of what Israel should do."* - 1 Chronicles 12:32

We exist to train disciple makers to use media strategically for Disciple Making Movements, equipping practitioners with practical strategies that bridge online engagement with face-to-face discipleship.

---

**Kingdom.Training** - Equipping the Church for Digital Discipleship
